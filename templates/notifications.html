{% extends "base.html" %}

{% block page_subtitle %}üîî Notifications{% endblock %}

{% block content %}
<!-- Page Header -->
<div class="page-header">
    <h1 class="page-title">üîî Notifications</h1>
    <div class="action-buttons">
        <a href="{{ url_for('notifications.generate_reminders') }}" class="btn btn-primary">
            <span>üîÑ</span> Generate Reminders
        </a>
        {% if notifications %}
        <a href="{{ url_for('notifications.mark_all_read') }}" class="btn btn-secondary" id="mark-all-read">
            <span>‚úì</span> Mark All Read
        </a>
        {% endif %}
    </div>
</div>

<!-- Notifications Filter Tabs -->
<div style="display: flex; gap: 8px; margin-bottom: 24px;">
    <a href="{{ url_for('notifications.index') }}" class="btn btn-primary btn-sm">All</a>
    <a href="{{ url_for('notifications.unread') }}" class="btn btn-secondary btn-sm">Unread</a>
</div>

<!-- Notifications List -->
{% if notifications %}
<div class="card">
    <div class="card-header">
        <h2 class="card-title">All Notifications</h2>
        <span style="color: var(--text-secondary);">{{ notifications|length }} notifications</span>
    </div>
    
    <div style="max-height: 600px; overflow-y: auto;">
        {% for notification in notifications %}
        <div class="notification-item {% if not notification.is_read %}unread{% endif %}" data-id="{{ notification.id }}">
            <div class="notification-icon {{ notification.notification_type }}">
                {% if notification.notification_type == 'reminder' %}
                ‚è∞
                {% elif notification.notification_type == 'alert' %}
                ‚ö†Ô∏è
                {% elif notification.notification_type == 'meeting' %}
                üìÖ
                {% else %}
                üîî
                {% endif %}
            </div>
            <div class="notification-content" style="flex: 1;">
                <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                    <div>
                        <div class="notification-title">{{ notification.title }}</div>
                        <div class="notification-message">{{ notification.message }}</div>
                    </div>
                    <div class="action-buttons">
                        {% if not notification.is_read %}
                        <a href="{{ url_for('notifications.mark_read', id=notification.id) }}" class="btn btn-sm btn-secondary" title="Mark as read">
                            ‚úì
                        </a>
                        {% endif %}
                        <a href="{{ url_for('notifications.delete', id=notification.id) }}" class="btn btn-sm btn-danger btn-delete" title="Delete">
                            üóëÔ∏è
                        </a>
                    </div>
                </div>
                <div style="display: flex; gap: 16px; margin-top: 8px; align-items: center;">
                    <span class="notification-time">
                        {{ notification.created_at.strftime('%b %d, %Y %H:%M') }}
                    </span>
                    {% if notification.lead %}
                    <a href="{{ url_for('leads.edit_lead', id=notification.lead.id) }}" style="font-size: 0.75rem; color: var(--primary-color);">
                        View Lead: {{ notification.lead.name }}
                    </a>
                    {% endif %}
                    {% if notification.action_date %}
                    <span style="font-size: 0.75rem; color: var(--text-secondary);">
                        Action by: {{ notification.action_date.strftime('%Y-%m-%d') }}
                    </span>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% else %}
<div class="empty-state">
    <div class="empty-state-icon">üîî</div>
    <p class="empty-state-title">No notifications</p>
    <p>You're all caught up! Notifications will appear here when leads need attention.</p>
    <a href="{{ url_for('notifications.generate_reminders') }}" class="btn btn-primary mt-4">
        <span>üîÑ</span> Check for Reminders
    </a>
</div>
{% endif %}

<!-- Notification Types Legend -->
<div class="card" style="background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);">
    <div class="card-header">
        <h2 class="card-title">üìö Notification Types</h2>
    </div>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
        <div style="display: flex; align-items: center; gap: 12px; padding: 12px; background: white; border-radius: var(--radius);">
            <div class="notification-icon reminder">‚è∞</div>
            <div>
                <strong>Reminders</strong>
                <p style="font-size: 0.75rem; color: var(--text-secondary);">Follow-up reminders</p>
            </div>
        </div>
        
        <div style="display: flex; align-items: center; gap: 12px; padding: 12px; background: white; border-radius: var(--radius);">
            <div class="notification-icon alert">‚ö†Ô∏è</div>
            <div>
                <strong>Alerts</strong>
                <p style="font-size: 0.75rem; color: var(--text-secondary);">High priority actions</p>
            </div>
        </div>
        
        <div style="display: flex; align-items: center; gap: 12px; padding: 12px; background: white; border-radius: var(--radius);">
            <div class="notification-icon meeting">üìÖ</div>
            <div>
                <strong>Meetings</strong>
                <p style="font-size: 0.75rem; color: var(--text-secondary);">Scheduled appointments</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}

